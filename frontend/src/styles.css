.app-root {
  font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
  padding: 18px;
  max-width: 1100px;
  margin: 24px auto;
  background: rgba(255,255,255,0.85);
  border-radius: 12px;
  box-shadow: 0 12px 40px rgba(16,24,40,0.12);
}
.app-title { margin: 8px 0; }
.hud { display: flex; gap: 12px; align-items: center; margin-bottom: 8px; font-size: 13px; }
.controls { display: flex; gap: 8px; align-items: center; }
.board-wrap { display: flex; gap: 16px; margin-top: 12px; flex-wrap: wrap; }
.board { position: relative; padding: var(--pad, 6px); border-radius: 10px; background: linear-gradient(180deg, #efe7dd 0%, #f7f3ef 100%); box-shadow: inset 0 2px 8px rgba(0,0,0,0.03); box-sizing: border-box; display:flex; align-items:center; justify-content:center; }
.grid { display: grid; gap: var(--gap, 6px); box-sizing: border-box; position: relative; z-index: 1; }
.cell { background: #fff; display:flex; align-items:center; justify-content:center; user-select:none; border-radius: 8px; box-shadow: 0 4px 10px rgba(16,24,40,0.06); width: var(--tile); height: var(--tile); }
.cell.legal { background: #eef7ee; cursor: pointer; }
.pawn { width:72%; height:72%; border-radius:50%; display:flex; align-items:center; justify-content:center; color:#111; font-size:13px; font-weight:700; box-shadow: 0 6px 18px rgba(16,24,40,0.18); border: 2px solid rgba(255,255,255,0.8); }
.pawn.p1 { background: linear-gradient(180deg,#ff8a65,#ff7043); }
.pawn.p2 { background: linear-gradient(180deg,#64b5f6,#3f9ae6); }
.pawn.p3 { background: linear-gradient(180deg,#81c784,#66bb6a); }
.pawn.p4 { background: linear-gradient(180deg,#ba68c8,#9c4fb8); }
.wall-h { position:absolute; height:14px; background:#333; border-radius:4px; }
.wall-v { position:absolute; width:14px; background:#333; border-radius:4px; }

.wall-h { transform: translateY(var(--anchor-h-offset, 5px)); transform-origin: center; }
.wall-v { transform: translateX(var(--anchor-v-offset, 5px)); transform-origin: center; }
.anchor { --anchor-h-offset: 5px; --anchor-v-offset: 5px; opacity: 0.95; cursor: pointer; transition: transform 0.12s ease, box-shadow 0.12s ease; border-radius:6px; position: relative; z-index: 20; }
.anchor:hover { transform: translateY(calc(-2px)); box-shadow: 0 8px 24px rgba(16,24,40,0.12); }
.anchor.valid { background: linear-gradient(180deg, rgba(76,175,80,0.98), rgba(56,150,55,0.95)); box-shadow: 0 6px 16px rgba(76,175,80,0.18); }
.anchor.invalid { display: none; }
.anchor-hit { position: absolute; background: transparent; border-radius: 8px; z-index: 30; pointer-events: auto; }
.anchor-hit:hover { background: rgba(0,0,0,0.04); }

/* ensure the hit area follows the same visual offset as the visible anchor
  so clicking the visible element actually triggers the hit area */
.anchor-hit.anchor-h { transform: translateY(var(--anchor-h-offset)); }
.anchor-hit.anchor-v { transform: translateX(var(--anchor-v-offset)); }
/* put the hit element above walls and anchors when hovered so it receives clicks */
.anchor-container .anchor-hit { z-index: 1202; }

/* when an anchor's container is hovered or focused, change the visible anchor color to dark gray */
/* when an anchor's container is hovered or focused, lift the container and anchor
   so the hovered anchor reliably renders above placed walls; also change color */
.anchor-container:hover, .anchor-container:focus-within {
  z-index: 1200; /* bring container above walls (walls are z-index:40) */
}
.anchor-container:hover .anchor, .anchor-container:focus-within .anchor {
  background: #4a4a4a; /* dark gray */
  box-shadow: 0 6px 18px rgba(0,0,0,0.18);
  z-index: 1201; /* ensure the anchor itself sits above the container stacking level */
}

/* when board has .hide-non-hover, hide all valid anchors except the hovered/focused one */
.board.hide-non-hover .anchor.valid { opacity: 0; pointer-events: none; }
.board.hide-non-hover .anchor-container:hover .anchor.valid, .board.hide-non-hover .anchor-container:focus-within .anchor.valid { opacity: 1; pointer-events: auto; }

/* show visual anchors slightly shorter to create a visible gap between adjacent anchors */
.anchor-h { margin-left: calc(var(--anchor-gap-x) / 2); margin-right: calc(var(--anchor-gap-x) / 2); width: calc(100% - var(--anchor-gap-x)); height: 100%; transform: translateY(var(--anchor-h-offset)); }
.anchor-v { margin-top: calc(var(--anchor-gap-y) / 2); margin-bottom: calc(var(--anchor-gap-y) / 2); height: calc(100% - var(--anchor-gap-y)); width: 100%; transform: translateX(var(--anchor-v-offset)); }

/* match the clickable hit area to the visible anchor so clicks only land where the anchor appears */
.anchor-container .anchor-hit.anchor-h { left: calc(var(--anchor-gap-x) / 2); right: calc(var(--anchor-gap-x) / 2); top: 0; bottom: 0; }
.anchor-container .anchor-hit.anchor-v { top: calc(var(--anchor-gap-y) / 2); bottom: calc(var(--anchor-gap-y) / 2); left: 0; right: 0; }

/* ensure walls and anchors are above the grid tiles */
.anchor { z-index: 20; }
.wall-h { z-index: 40; }
.wall-v { z-index: 40; }

/* anchor container: allow pointer-events on the container so :hover/:focus-within
  can raise its stacking context; the .anchor-hit remains the interactive target */
.anchor-container { position: absolute; pointer-events: auto; z-index: 22; }
.anchor-container .anchor { pointer-events: none; }
.anchor-container .anchor-hit { pointer-events: auto; }

.legend { display:flex; gap:8px; align-items:center; margin-bottom:8px; }
.legend .item { display:flex; gap:8px; align-items:center; }
.legend .swatch { width:18px; height:18px; border-radius:4px; }
.sidebar { min-width:260px; }
.players-list { margin:8px 0; }
.players-list li { margin-bottom:4px; }
.state-pre { max-height:350px; overflow:auto; background:#fff; border:1px solid #eee; padding:8px; }
.controls button { padding:6px 8px; }

@media (max-width: 700px) {
  .board { width: 90vw; height: 90vw; }
  .board-wrap { flex-direction: column-reverse; align-items: center; }
  .sidebar { min-width: auto; width: 90vw; }
}

.overlay {
  position: fixed;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0.45);
  z-index: 2000;
}
.modal {
  background: #fff;
  padding: 20px 24px;
  border-radius: 8px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.2);
  min-width: 300px;
}
.modal input[readonly] { background:#f7f7f7; border:1px solid #eee; border-radius:6px; }
.copy-row { display:flex; gap:8px; align-items:center; }
.copied { background: #4caf50; color: white; }
.modal h2 { margin: 0 0 12px 0; }
.modal .actions { display:flex; gap:8px; margin-top:12px; justify-content:flex-end; }
.btn { padding: 8px 12px; border-radius:6px; border: none; cursor: pointer; }
.btn.primary { background:#1976d2; color:#fff; }
.btn.ghost { background: #f3f3f3; }

/* Start screen */
.start-screen {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(180deg, rgba(10,20,30,0.4), rgba(10,20,30,0.6));
  z-index: 3000;
}
.start-card {
  background: #fff;
  padding: 28px;
  border-radius: 12px;
  box-shadow: 0 18px 60px rgba(2,6,23,0.6);
  width: min(760px, 92vw);
  text-align: center;
}
.start-card h2 { margin: 0 0 8px 0; font-size: 28px; }
.start-card .muted { color: #666; margin-bottom: 14px; }
.start-actions { display:flex; gap:12px; justify-content:center; margin: 16px 0; }
.btn.large { padding: 12px 18px; font-size: 16px; border-radius: 10px; }
.start-settings { margin-top: 8px; display:flex; justify-content:center; gap:8px; align-items:center; }
.settings-panel { margin-top: 8px; display:flex; gap: 12px; align-items:center; justify-content:center; }
.settings-panel label { display:flex; flex-direction:column; font-size:13px; gap:6px; }
.settings-panel input[type="number"], .settings-panel select { padding:6px 8px; border-radius:6px; border:1px solid #ddd; min-width: 120px; }

@media (max-width: 700px) {
  .start-card { padding: 18px; }
  .start-card h2 { font-size: 20px; }
  .start-actions { flex-direction: column; }
  .settings-panel { flex-direction: column; }
}

/* homepage layout */
.homepage .home-grid { display: grid; grid-template-columns: 1fr 360px; gap: 20px; align-items: start; }
.homepage .home-left { padding: 18px; }
.homepage .home-right { padding: 18px; border-left: 1px dashed #eee; }
.game-name { font-size: 36px; margin: 0 0 8px 0; }
.rules { background: #fff; border-radius: 8px; padding: 12px; box-shadow: 0 6px 18px rgba(2,6,23,0.06); }
.rules h3 { margin-top: 0; }

@media (max-width: 880px) {
  .homepage .home-grid { grid-template-columns: 1fr; }
  .homepage .home-right { border-left: none; border-top: 1px dashed #eee; }
}
